---
layout: post
title:  "Tree Iterator"
categories: [data structures]
scripts: 
  - url: "https://cdn.jsdelivr.net/npm/vue@2.6.0/dist/vue.min.js"
    type: "absolute"
  - url: "/assets/src/TreeIterator.js"
    type: "relative"
inlinescript: >
  <script>
  const app = new Vue({
    el: '#app',
    data: {
      loggerLength: 50,
      logger: [],
    },
    methods: {
      log: function (str) {
        this.logger.push(str);
        while (this.logger.length > this.loggerLength) {
          this.logger.shift();
        } 
      },
      run: function () {
        const node = {
          "name": "root",
          "disabled": true
        };
        const list = {
          "name": "root",
          "contents": [
            { "name": "list1", "disabled": false },
            { "name": "list2", "disabled": true },
            { "name": "list3", "disabled": false }
          ]
        };
        const mytree = {
          "name": "root",
          "contents": [
            {
              "name": "descendant1", "contents": [
                {
                  "name": "descendant1.1", "contents": [
                    { "name": "descendant1.1.1" },
                    { "name": "descendant1.1.2", "contents": [
                      { "name": "descendant1.1.2.1" },
                      { "name": "descendant1.1.2.2" },
                      { "name": "descendant1.1.2.3", "disabled": true },
                      { "name": "descendant1.1.2.4" }
                    ]},
                    { "name": "descendant1.1.3" }
                  ]
                }
              ]
            },
            { "name": "descendant2", "contents": [], "disabled": false },
            {
              "name": "descendant3", "contents": [
                { "name": "descendant3.1"},
                { "name": "descendant3.2" }
              ], "disabled": true
            },
            { "name": "descendant4", "contents": [] },
          ]
        }
        let transformFn = function (v, i, it) {
          return !v.disabled;
        }
        let iterator = new TreeIterator(node), step;
        iterator.setTransform(transformFn);
        while ((step = iterator.next()) && !step.done) {
          this.log(["node", step.value.name].join(' '));
        }
        iterator.setTree(list);
        while ((step = iterator.next()) && !step.done) {
          this.log(["list", step.value.name].join(' '));
        }
        iterator.setTree(mytree);
        while (iterator.step() && !iterator.done()) {
          step = iterator.current();
          this.log(["tree", step.name].join(' '));
        }
        iterator.reset();
        for (step of iterator) {
          this.log(["for ... of tree", step.name].join(' '));
        }
      }
    }
  });  
  </script>
---
<div id="app" class="app">
  <pre>
{%- highlight javascript -%}
function transformFn (node, step count, iterator) {
  // return true to include node in iterator output
  return true;
}
let iterator = new TreeIterator(mytree), step;
iterator.setTransform(transformFn);
while (iterator.step() && !iterator.done()) {
  // do something with iterator.current()
}
while ((step = iterator.next()) && !step.done) {
  // do something with step.value
}
// or
for (step of iterator) {
  // do something with step
}
{%- endhighlight -%}
  </pre>
  {% raw %}
  <button class="app-button" @click.prevent="run()">Run</button>
  <p>results</p>
  <pre><template v-for="msg in logger">{{ msg }}<br /></template></pre>
  {% endraw %}
</div>
